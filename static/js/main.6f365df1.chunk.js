(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{34:function(e,t,a){e.exports=a(50)},43:function(e,t,a){},50:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(22),c=a.n(o),s=a(5),i=a(4),u=a(16),l=a(31),p=a(32),m=a(20),f=Object(u.combineReducers)({movies:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MOVIES":return t.movies;case"TOGGLE_FAVORITE_MOVIE":return e.map(function(e){return e.id===t.id?Object(m.a)({},e,{favorited:!e.favorited}):e});case"CLEAR_FAVORITE_MOVIES":return e.map(function(e){return Object(m.a)({},e,{favorited:!1})});case"SET_FAVORITES_ON_LOG_IN":return e.map(function(e){return t.favorites.forEach(function(t){t.movie_id===e.id&&(e.favorited=!0)}),e});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_LOGIN":return t.user;case"USER_LOGOUT":return{};default:return e}},isLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IS_LOADING":return t.isLoading;default:return e}},error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"HAS_ERRORED":return t.message;default:return e}}}),v=(a(43),a(1)),d=a.n(v),h=a(3),E=a(10),b=a(11),g=a(13),O=a(12),w=a(14),y=function(){var e=Object(h.a)(d.a.mark(function e(t,a){var r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,a);case 2:if(!(r=e.sent).ok){e.next=9;break}return e.next=6,r.json();case 6:return e.abrupt("return",e.sent);case 9:throw Error(r.statusText);case 10:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),j=function(e){return e.map(function(e){var t=e.id,a=e.title,r=e.vote_average,n=e.overview,o=e.release_date;return{id:t,title:a,posterImage:"https://image.tmdb.org/t/p/w185_and_h278_bestv2"+e.poster_path,release_date:o,vote_average:r,overview:n,favorited:!1}})},S=function(e){return{type:"SET_MOVIES",movies:e}},_=function(e){return{type:"TOGGLE_FAVORITE_MOVIE",id:e}},N=function(e){return{type:"USER_LOGIN",user:e}},x=function(e){return{type:"IS_LOADING",isLoading:e}},C=Object(i.b)(function(e){return{user:e.user}},function(e){return{logOutUser:function(){return e({type:"USER_LOGOUT"})},clearFavoriteMovies:function(){return e({type:"CLEAR_FAVORITE_MOVIES"})}}})(function(e){return n.a.createElement("header",{className:"Header"},n.a.createElement("nav",null,n.a.createElement(s.c,{exact:!0,to:"/",className:"nav title"},n.a.createElement("h1",null,"thriller tracker")),e.user.email&&n.a.createElement("div",null,n.a.createElement("h3",null,"Welcome, ",e.user.name,"!"),n.a.createElement(s.c,{exact:!0,to:"/favorites",className:"nav fave"},"Favorites"),n.a.createElement(s.c,{exact:!0,to:"/login",className:"nav",onClick:function(){e.logOutUser(),e.clearFavoriteMovies()}},"Sign Out")),!e.user.email&&n.a.createElement("div",null,n.a.createElement("h3",null,"Welcome!"),n.a.createElement(s.c,{exact:!0,to:"/login",className:"nav"},"Login"),n.a.createElement(s.c,{exact:!0,to:"/sign-up",className:"nav"},"Sign Up"))))}),k=a(17),F=function(e,t){return function(){var a=Object(h.a)(d.a.mark(function a(r){var n,o;return d.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n="http://localhost:3000/api/users/".concat(t,"/favorites/").concat(e),o={method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({movie_id:e,user_id:t})},a.next=4,y(n,o);case 4:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()},I=function(e,t){return function(){var a=Object(h.a)(d.a.mark(function a(r){var n,o,c,s,i,u,l;return d.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.id,o=e.title,c=e.posterImage,s=e.release_date,i=e.vote_average,u=e.overview,"http://localhost:3000/api/users/favorites/new",l={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({movie_id:n,user_id:t,title:o,poster_path:c,release_date:s,vote_average:i,overview:u})},a.next=5,y("http://localhost:3000/api/users/favorites/new",l);case 5:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()},T=function(e){function t(){var e,a;Object(E.a)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(a=Object(g.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(n)))).handleFavoriteClick=function(){var e=a.props.user.id;if(!e)return alert("Login or Signup to favorite movies");var t=a.props.m,r=t.id,n=t.favorited,o=a.props.m;a.props.toggleFavoriteMovie(r),n?a.props.deleteFavorite(r,e):a.props.addFavorite(o,e)},a}return Object(w.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.m,t=e.id,a=e.title,r=e.posterImage,o=e.favorited?"fas fa-heart fa-2x favorited":"fas fa-heart fa-2x";return n.a.createElement("div",{className:"Card"},n.a.createElement("i",{onClick:this.handleFavoriteClick,className:o}),n.a.createElement(s.b,{to:"/movies/".concat(t)},n.a.createElement("img",{src:r,alt:a+" poster"})))}}]),t}(r.Component),L=Object(i.b)(function(e){return{user:e.user}},function(e){return{toggleFavoriteMovie:function(t){return e(_(t))},addFavorite:function(t,a){return e(I(t,a))},deleteFavorite:function(t,a){return e(F(t,a))}}})(T),R=Object(i.b)(function(e){return{movies:e.movies}})(function(e){var t=e.movies.map(function(e,t){return n.a.createElement(L,{key:t,m:e})});return n.a.createElement("section",{className:"Home"},t)}),A=Object(i.b)(function(e){return{movies:e.movies}})(function(e){var t=e.movies.map(function(e,t){return e.favorited?n.a.createElement(L,{key:t,m:e}):null});return n.a.createElement("section",{className:"Favorites"},t)}),U=a(18),M=function(e){function t(){var e;return Object(E.a)(this,t),(e=Object(g.a)(this,Object(O.a)(t).call(this))).handleSubmit=function(){var t=Object(h.a)(d.a.mark(function t(a){var r;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.next=3,e.props.loginUser(e.state);case 3:return r=t.sent,t.next=6,e.props.fetchFavorites(r.data.id);case 6:r?e.setState({status:r.status}):e.showError();case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),e.showError=function(){document.querySelector(".error").style.color="#760a0a"},e.handleChange=function(t){var a=t.target,r=a.name,n=a.value;e.setState(Object(U.a)({},r,n))},e.state={email:"",password:"",status:""},e}return Object(w.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){return n.a.createElement("form",{className:"user-form",onSubmit:this.handleSubmit},n.a.createElement("h2",null,"Login"),n.a.createElement("p",{className:"error"},"Email and Password do not match"),n.a.createElement("label",{htmlFor:"email"},"Email"),n.a.createElement("input",{onChange:this.handleChange,name:"email",type:"email",id:"email",placeholder:"Email"}),n.a.createElement("label",{htmlFor:"password"},"Password"),n.a.createElement("input",{onChange:this.handleChange,name:"password",type:"password",id:"password",placeholder:"Password"}),n.a.createElement("button",null,"Login"),this.state.status&&n.a.createElement(k.a,{to:"/"}))}}]),t}(r.Component),G=Object(i.b)(null,function(e){return{logInUser:function(t){return e(N(t))},loginUser:function(t){return e(function(e){return function(){var t=Object(h.a)(d.a.mark(function t(a){var r,n,o,c;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=e.email,n=e.password,o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:n})},t.next=6,y("http://localhost:3000/api/users",o);case 6:return c=t.sent,a(N(c.data)),t.abrupt("return",c);case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0);case 14:case"end":return t.stop()}},t,null,[[0,11]])}));return function(e){return t.apply(this,arguments)}}()}(t))},fetchFavorites:function(t){return e(function(e){return function(){var t=Object(h.a)(d.a.mark(function t(a){var r,n;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r="http://localhost:3000/api/users/".concat(e,"/favorites"),t.next=3,y(r);case 3:n=t.sent,a({type:"SET_FAVORITES_ON_LOG_IN",favorites:n.data});case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}(t))}}})(M),V=function(e){function t(){var e;return Object(E.a)(this,t),(e=Object(g.a)(this,Object(O.a)(t).call(this))).handleSubmit=function(){var t=Object(h.a)(d.a.mark(function t(a){var r;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.next=3,e.props.createNewUser(e.state);case 3:(r=t.sent)?e.setState({status:r.status}):e.showError();case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),e.createUser=function(t){var a=t.name,r=t.email,n=t.password,o={name:a,email:r,password:n},c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a,email:r,password:n})};fetch("http://localhost:3000/api/users/new",c).then(function(t){console.log("response ok?:",t.ok),console.log("response:",t),e.setState({status:t.status}),t.ok?e.props.logInUser(o):e.showError()}).catch(function(e){return console.log("error",e)})},e.showError=function(){document.querySelector(".error").style.color="#760a0a"},e.handleChange=function(t){e.setState(Object(U.a)({},t.target.name,t.target.value))},e.state={name:"",email:"",password:"",status:""},e}return Object(w.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){return n.a.createElement("form",{className:"user-form",onSubmit:this.handleSubmit},n.a.createElement("h2",null,"Create Account"),n.a.createElement("p",{className:"error"},"Email has already been used"),n.a.createElement("label",{htmlFor:"name"},"Name"),n.a.createElement("input",{onChange:this.handleChange,name:"name",type:"text",id:"name",className:"userProp"}),n.a.createElement("label",{htmlFor:"email"},"Email"),n.a.createElement("input",{onChange:this.handleChange,name:"email",type:"email",id:"email",className:"userProp"}),n.a.createElement("label",{htmlFor:"password"},"Password"),n.a.createElement("input",{onChange:this.handleChange,name:"password",type:"password",id:"password",className:"userProp"}),n.a.createElement("button",null,"Create ",n.a.createElement("i",{className:"fas fa-angle-right"})),"success"===this.state.status&&n.a.createElement(k.a,{to:"/"}))}}]),t}(r.Component),P=Object(i.b)(null,function(e){return{logInUser:function(t){return e(N(t))},createNewUser:function(t){return e(function(e){return function(){var t=Object(h.a)(d.a.mark(function t(a){var r,n,o,c,s,i;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=(r=e).name,o=r.email,c=r.password,e={name:n,email:o,password:c},s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,email:o,password:c})},t.next=7,y("http://localhost:3000/api/users/new",s);case 7:return i=t.sent,a(N(Object(m.a)({},e,{id:i.id}))),t.abrupt("return",i);case 12:t.prev=12,t.t0=t.catch(0),console.log("error",t.t0);case 15:case"end":return t.stop()}},t,null,[[0,12]])}));return function(e){return t.apply(this,arguments)}}()}(t))}}})(V),D=function(e){function t(){var e,a;Object(E.a)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(a=Object(g.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(n)))).handleFavoriteClick=function(){var e=a.props.user.id;if(!e)return alert("Login or Signup to favorite movies");var t=a.props,r=t.id,n=t.favorited,o=a.props;a.props.toggleFavoriteMovie(r),n?a.props.deleteFavorite(r,e):a.props.addFavorite(o,e)},a}return Object(w.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props,t=e.title,a=e.vote_average,r=e.overview,o=e.posterImage,c=e.release_date,i=e.favorited?"fas fa-heart fa-2x favorited":"fas fa-heart fa-2x";return n.a.createElement("section",{className:"Card-Details"},n.a.createElement("h2",null,t),n.a.createElement("i",{onClick:this.handleFavoriteClick,className:i}),n.a.createElement("h5",null,"Released",n.a.createElement("span",null,c.slice(0,4))),n.a.createElement("h6",null,a,"/10",n.a.createElement("i",{className:"far fa-star"})),n.a.createElement("p",null,r),n.a.createElement("img",{src:o,alt:t+" poster"}),n.a.createElement(s.b,{className:"btn",to:"/"},n.a.createElement("button",{className:"back-btn"},n.a.createElement("i",{className:"fas fa-angle-left"})," Back to results")))}}]),t}(r.Component),J=Object(i.b)(function(e){return{user:e.user}},function(e){return{toggleFavoriteMovie:function(t){return e(_(t))},addFavorite:function(t,a){return e(I(t,a))},deleteFavorite:function(t,a){return e(F(t,a))}}})(D),H=Object(i.b)(function(e){return{movies:e.movies}})(function(e){return n.a.createElement("section",{className:"Content-Container"},n.a.createElement(k.b,{exact:!0,path:"/",component:R}),n.a.createElement(k.b,{exact:!0,path:"/favorites",component:A}),n.a.createElement(k.b,{exact:!0,path:"/login",component:G}),n.a.createElement(k.b,{exact:!0,path:"/sign-up",component:P}),n.a.createElement(k.b,{path:"/movies/:id",render:function(t){var a=t.match.params.id,r=e.movies.find(function(e){return e.id===parseInt(a)});if(r)return n.a.createElement(J,r)}}))}),W="7b44bb1f4812a66d32d5ee714c8361a3",q=function(e){function t(){var e,a;Object(E.a)(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(a=Object(g.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(n)))).componentDidMount=Object(h.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.length||(t="https://api.themoviedb.org/3/discover/movie?api_key=".concat(W,"&with_genres=27"),a.props.fetchMovies(t));case 1:case"end":return e.stop()}},e)})),a}return Object(w.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"App"},n.a.createElement(C,null),n.a.createElement(H,null))}}]),t}(r.Component),B=Object(i.b)(null,function(e){return{fetchMovies:function(t){return e(function(e){return function(){var t=Object(h.a)(d.a.mark(function t(a){var r,n;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a(x(!0)),t.next=4,y(e);case 4:r=t.sent,n=j(r.results),a(x(!1)),a(S(n)),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),a({type:"HAS_ERRORED",message:t.t0.message});case 13:case"end":return t.stop()}},t,null,[[0,10]])}));return function(e){return t.apply(this,arguments)}}()}(t))}}})(q),z=function(){try{var e=localStorage.getItem("state");if(null===e)return;return JSON.parse(e)}catch(t){return}}(),K=Object(u.createStore)(f,z,Object(p.composeWithDevTools)(Object(u.applyMiddleware)(l.a)));K.subscribe(function(){!function(e){try{var t=JSON.stringify(e);localStorage.setItem("state",t)}catch(a){console.log("Error saving to localStorage: ",a)}}(K.getState())});var Q=n.a.createElement(i.a,{store:K},n.a.createElement(s.a,null,n.a.createElement(B,null)));c.a.render(Q,document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.6f365df1.chunk.js.map